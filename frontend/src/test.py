import urllib.request
import json

# Request data goes here
# The example below assumes JSON formatting which may be updated
# depending on the format your endpoint expects.
# More information can be found here:
# https://docs.microsoft.com/azure/machine-learning/how-to-deploy-advanced-entry-script
user_id = 4529878129942
content_ids = [2267321579404324900, -1523691178084871, -1038011342017850, 6099026883115865746, -1251258405608426882, 790210667253898984,
    1536798472239364319, -5881946480525580860, 1737303669706106633,
    -5920475612630001479, -615862350872519037, -4996336942690402156,
    1233935898842140014, -8202212195240926680, 8748370453256790422,
    5087084654882097891, -8996656559398843485, -2164628725543527116,
    2515874237935914763, -1606909838151129701, 5817939718364925129,
    5817939718364925129, 2628816849077589497, -847494979958007433,
    -7527881206365368, 5949788789046720741, 3467834993860080188,
    660451400045043370, -4280604324733069853, 524776334673868069,
    5842191581670322333, -5658245291907121574, 7182931494487573654,
    5761988486867612282, -8047634385511625486, 826748584447376099,
    6678691743269420670, 1990052153136096105, 1184320069221244535,
    5854206600849997966, 1971653634364577968, -6380034335041404646,
    7013665235990336340, -427385793606723821, 8416004328454490172,
    8416004328454490172, -2890958311805113955, 5779887740609126631,
    378386436485699053, -8800029253812071912, 6766105865162331239,
    3585886677712899987, 3196303498841885455, 7174452660053929140,
    7727369224210483739, 8946250624470221174, 363798057559041921,
    -5403733687257676872, -7539647701814009718, 2081512200574495983,
    -3040610224044779845, -3258959365023720872, -4309525417316029305,
    -7555896091148631419, -9089854794058353436, -5829979886567267504,
    -3387298624573211014, -4487024160266973763, -3130182799308303924,
    -1452340812018195881, 1059874396577697902, 5328558001212551235,
    54211792749134075, -6537529846890876234, -8992201526199201450,
    -5843518165523212471, 8856169137131817223, 2715453133655798791,
    1992928170409443117, -4024778022934140027, -1787737696395220629,
    -4195851681734441295, 711995695898078056, 7506614456429888492,
    -3058031327323357308, 5901067357946111913, -3295730307439884506,
    -3073433549435888423, -7977868424702448788, -7762049078455894395,
    2096088841518695759, -3248233692182971167, -8278375716950339547,
    -4893195573827770029, 3151913710743441986, 2725842723638001955,
    6800965548226529308, 5929055844564382383, 5053372977408537204,
    -7463572107837163154, -8680242653057858999, 2847365042071859088,
    -713893030279048092, 2847365042071859088, 4869691310149728361,
    -2358644309529026633, 6892165923784661946, -2139739377293212491,
    4164212115654350513, -8480712303720557641, 4780818054552370624,
    -6511604233888915532, 4859179221363512189, -1609424513692297222,
    -7388035385087807288, 6195056361889291497, 4428409432282393251,
    8289311442635691404, 3058137260516373249, 5271205718596251417,
    -3060116862184714437, -4561077506184283336, 8195862936106508846,
    1851975995406778464, 9045808098977760576, 7138108653908662095,
    -7666273193533605701, -3071732669882279801, -8954346068661072425,
    -4582216289807398227, -1173087925894083974, 6985167957194730651,
    2642993575444549134, -4333957157636611418, 4700641534148321049,
    -1525688508571111688, 5967886403500658324, 6892866957050839435,
    7926736692763443624, 2531450382701518075, 722931447608069342,
    -8885776096632729273, 1829180586132834070, 9209886322932807692,
    -5231736210378596444, -6119620726358216329, 6049739262059615567,
    7636423839699365160, -8582642829303844420, -1243978819371381632,
    3385087622593663739, 8769121796537771237, 8340838192486391835,
    3032648342029994387, -6590064508646491981, -5729915270134094048,
    -4163754746025598258, -1072987232233605661, -3267081294086663175,
    4647928672998188259, 1115750778137998115, 2441555519716118559,
    -4270702541777554377, -5637143900506554933, 5847042211895226591,
    6669026579073415958, 5258604889412591249, 393734797767236089,
    393734797767236089, -5011709367955107239, -6564402465035266866,
    2314077149264083254, 6187300944962737279, -4205603734017049464,
    -6579094253358169934, 7202701636941380671, 2543311963908571128,
    -8606063418076691067, 6591221581057159843, 1642787330067525131,
    -4831310174172854034, 4532698165746826599, 3262705634545542432,
    -7732246497578572511, 7814856426770804213, 6797493571710971497,
    -8009994379436553252, 5688444173453700360, 4815632823882298534,
    -78667914647336721, 1649752043999819668, -2940536914889279273,
    7345394467579731315, 6389624212149850449, -8657415528200615063,
    -6215634663594744290, -8781597910014596432, 1117455951802655890,
    6658481071718074876, -8615008595949058842, -3307413259092352650,
    3465127447598546258, -2440547657721869309, 7401798504722165526,
    -2855218766021441159, -91139000311163410, -6642751159620064055,
    -498795758651788662, 8628621643938810986, 6034099213718885791,
    5524888769622800245, -790959521412948853, -6510151088126868601,
    4422997595777504091, -9056114023474725450, 2106559900295325351,
    6947862790919978120, -3751249597609107201, 2399228553079505025,
    -8068727428160395745, -3513353119850106583, -3351652027149912881,
    -4483059513836093676, -6932442635231192683, -266262937631881148,
    4904775878165401439, -7423191370472335463, -1353560213232970946,
    6908884359295619150, 3399073250354435892, 3399073250354435892,
    4717008760225392411, -1511619461666295654, -8677396111092711799,
    -9152398073968262186, -1606980109000976010, 3293246847422795557,
    5263606973029607223, 8836508987743809103, -1425776303341065806,
    -8353590933060505654, -4451918963121780798, 4667058261084775379,
    8926283897590637985, 3056097063387494549, -9086955082453789880,
    -2780168264183400543, -3269885695260066314, 8353614127518545485,
    4671890082953295903, 6750029764020453263, -6245524727898921842,
    -6466212324513658217, -4158297476631283435, 7334805502505837712,
    -4293262855938209141, -6772450850499951060, -623310439329591027,
    231281690254211527, -7905002887579197656, -7130425546996181071,
    -5895530418852362770, 7529823674661315431, -2871347907044769386,
    6999813113145211708, 1328618437884612347, -3348652277274905234,
    -2167839778474325326, 7850245260835292221, -3687965339291665275,
    -1878569380455769122, -253149055249888078, -8145607370067359341,
    319340024738595907, 5313335392004163852, -4925213312961842798,
    6222001809679591440, 6870972580508513306, 8243193415815549463,
    6917508501173008954, 8428597553954921991, 1639450243805666792,
    2215773447123360543, 7978090893338710234, -5689187996536546877,
    -2808959554282640221, -6584408680441477889, -1129449063360470561,
    8786528563105605644, -5470166294767187597, 3288699993147470797,
    3739926497176994524, -7646922141533719881, 3801658304588389996,
    -3745582971859460684, 1873952032843878490, 3116298625885250927,
    -1104501717379772664, 1561244083438776495, -547324075613341407,
    -2555801390963402198, -7294716554902079523, 4746056663292225769,
    7263689301643675785, 7511744555558105059, -3870325027932266414,
    -5570795524983603787, -759389978085260161, 8355302955998803709,
    -6739959707791598779, -2400879112398974660, 7203367456821804602,
    4895396506368139469, 6634206168889468590, 5005421293875190218,
    4037478513037442964, -4640750981890093183, 6868454399455433725,
    6953968734027801757, -5790539535722288419, 2841545035570793472,
    2171312647242674161, 3382987666565638029, -8535131855706279960,
    2867605706298498445, -3951274083288934897, 1450769039556893440,
    4169374063813159761, 4169374063813159761, 8310689940464940949,
    -885453047081832598, -7499831854130267106, 7934258011380835332,
    6104598399077154797, -7529178973676767391, 4677417698542178243,
    -2962461122453899874, -807868207410889392, 6407605752151817831,
    -273156842634169039, 3772685586944428188, -241724866433160984,
    -4070929606295451361, 2121807307434667949, -1306208577536428610,
    881166463209244600, 8869347744613364434, -1101361754763388054,
    2006478190737700267, 962287586799267519, 3380406830501456504,
    -434149774629603391, 564282370384747453, 8640945691036622521,
    7088167897470452815, -2123288010168989418, -2097075598039554565,
    -3020916840917845519, -2405892683303291957, -4358357193736101128,
    3716124214746295857, -5736221996280340620, -6659933088254630422,
    -6639617916149472585, -1463025432902754108, -1878128207048892154,
    -1324705355456975418 ]

data = {
    "Inputs": {
        "WebServiceInput0": [
            {"personId": user_id, "contentId": cid} for cid in content_ids
        ]
    }
}


body = str.encode(json.dumps(data))

url = 'http://2bd92409-589d-46be-959c-76d6eaf53f46.eastus2.azurecontainer.io/score'
# Replace this with the primary/secondary key, AMLToken, or Microsoft Entra ID token for the endpoint
api_key = 'cmCRPLiMB5N11an7fDqVKKix4ueRnKqs'
if not api_key:
    raise Exception("A key should be provided to invoke the endpoint")


headers = {'Content-Type':'application/json', 'Accept': 'application/json', 'Authorization':('Bearer '+ api_key)}

req = urllib.request.Request(url, body, headers)

try:
    response = urllib.request.urlopen(req)

    result = response.read()
    print(result)
except urllib.error.HTTPError as error:
    print("The request failed with status code: " + str(error.code))

    # Print the headers - they include the requert ID and the timestamp, which are useful for debugging the failure
    print(error.info())
    print(error.read().decode("utf8", 'ignore'))
